{"version":3,"file":"page-IQcJ-0GO.js","sources":["../../src/hooks/useTodayReservationsForMobile.ts","../../src/pages/admin/mobile/page.tsx"],"sourcesContent":["import { useCallback, useEffect, useMemo, useState } from 'react';\nimport { convertToLegacyFormat, subscribeToReservations } from '../lib/dashboardHelper';\nimport { reservationService } from '../lib/supabase';\n\nexport type MobileReservation = ReturnType<typeof convertToLegacyFormat>;\ntype ServiceKey = MobileReservation['service'];\n\nconst SERVICE_ORDER: ServiceKey[] = ['hotel', 'grooming', 'daycare'];\n\nconst sortReservations = (items: MobileReservation[]) => {\n  return [...items].sort((a, b) => {\n    const serviceDiff = SERVICE_ORDER.indexOf(a.service) - SERVICE_ORDER.indexOf(b.service);\n    if (serviceDiff !== 0) return serviceDiff;\n    const timeA = a.time || '99:99';\n    const timeB = b.time || '99:99';\n    return timeA.localeCompare(timeB);\n  });\n};\n\nconst getKstDateKey = () => {\n  const now = new Date();\n  const utc = now.getTime() + now.getTimezoneOffset() * 60 * 1000;\n  const kst = new Date(utc + 9 * 60 * 60 * 1000);\n  return kst.toISOString().split('T')[0];\n};\n\nexport function useTodayReservationsForMobile(enabled: boolean = true) {\n  const todayKey = useMemo(() => getKstDateKey(), []);\n  const [reservations, setReservations] = useState<MobileReservation[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const filterToday = useCallback(\n    (items: MobileReservation[]) =>\n      items.filter(\n        (reservation) =>\n          reservation.date === todayKey &&\n          reservation.status !== 'cancelled' &&\n          reservation.status !== 'deleted',\n      ),\n    [todayKey],\n  );\n\n  const fetchReservations = useCallback(async () => {\n    if (!enabled) return;\n    setIsRefreshing(true);\n    setError(null);\n    try {\n      const data = await reservationService.getByDate(todayKey);\n      const normalized = filterToday(data.map(convertToLegacyFormat));\n      setReservations(sortReservations(normalized));\n    } catch (err) {\n      console.error('Failed to load today reservations:', err);\n      setError('오늘 예약을 불러오지 못했습니다. 잠시 후 다시 시도해주세요.');\n    } finally {\n      setIsLoading(false);\n      setIsRefreshing(false);\n    }\n  }, [enabled, filterToday, todayKey]);\n\n  const handleRealtimeUpdate = useCallback(\n    (payload: { type: string; data?: MobileReservation; id?: string }) => {\n      setReservations((current) => {\n        if (payload.type === 'DELETE' && payload.id) {\n          return current.filter((reservation) => reservation.id !== payload.id);\n        }\n        const updatedReservation = payload.data;\n        if (!updatedReservation) {\n          return current;\n        }\n        if (\n          updatedReservation.date !== todayKey ||\n          updatedReservation.status === 'cancelled' ||\n          updatedReservation.status === 'deleted'\n        ) {\n          return current.filter((reservation) => reservation.id !== updatedReservation.id);\n        }\n        const existing = current.find((reservation) => reservation.id === updatedReservation.id);\n        const next = existing\n          ? current.map((reservation) =>\n              reservation.id === updatedReservation.id ? updatedReservation : reservation,\n            )\n          : [...current, updatedReservation];\n        return sortReservations(next);\n      });\n    },\n    [todayKey],\n  );\n\n  useEffect(() => {\n    if (!enabled) {\n      setIsLoading(false);\n      return;\n    }\n    let subscription: ReturnType<typeof subscribeToReservations> | null = null;\n    fetchReservations();\n    subscription = subscribeToReservations(handleRealtimeUpdate);\n    return () => {\n      subscription?.unsubscribe?.();\n    };\n  }, [enabled, fetchReservations, handleRealtimeUpdate]);\n\n  const grouped = useMemo(() => {\n    return {\n      grooming: sortReservations(reservations.filter((reservation) => reservation.service === 'grooming')),\n      hotel: sortReservations(reservations.filter((reservation) => reservation.service === 'hotel')),\n      daycare: sortReservations(reservations.filter((reservation) => reservation.service === 'daycare')),\n    };\n  }, [reservations]);\n\n  return {\n    todayGrooming: grouped.grooming,\n    todayHotel: grouped.hotel,\n    todayDaycare: grouped.daycare,\n    refresh: fetchReservations,\n    isLoading,\n    isRefreshing,\n    error,\n    todayKey,\n  };\n}\n","import { useEffect, useMemo, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { adminService } from '../../../lib/supabase';\nimport {\n  changeReservationStatus,\n  deleteReservation as deleteReservationAction,\n  type ReservationStatus,\n} from '../../../lib/adminReservationActions';\nimport {\n  useTodayReservationsForMobile,\n  type MobileReservation,\n} from '../../../hooks/useTodayReservationsForMobile';\n\nconst SERVICE_LABELS: Record<MobileReservation['service'], string> = {\n  grooming: '미용',\n  hotel: '호텔',\n  daycare: '데이케어',\n};\n\nconst SERVICE_SECTIONS: Array<{ key: MobileReservation['service']; title: string }> = [\n  { key: 'grooming', title: '1. 오늘 미용 예약' },\n  { key: 'hotel', title: '2. 오늘 호텔 예약' },\n  { key: 'daycare', title: '3. 오늘 데이케어 예약' },\n];\n\nconst STATUS_LABELS: Record<MobileReservation['status'], string> = {\n  pending: '대기',\n  confirmed: '확정',\n  completed: '완료',\n  cancelled: '취소',\n  deleted: '삭제됨',\n};\n\nconst STATUS_STYLES: Record<MobileReservation['status'], string> = {\n  pending: 'bg-amber-50 text-amber-700 border-amber-200',\n  confirmed: 'bg-emerald-50 text-emerald-700 border-emerald-200',\n  completed: 'bg-slate-100 text-slate-600 border-slate-200',\n  cancelled: 'bg-rose-50 text-rose-700 border-rose-200',\n  deleted: 'bg-rose-50 text-rose-700 border-rose-200',\n};\n\nconst formatReservationDate = (dateStr: string) => {\n  if (!dateStr) return '';\n  const target = new Date(`${dateStr}T00:00:00`);\n  if (Number.isNaN(target.getTime())) return dateStr;\n  try {\n    const formatter = new Intl.DateTimeFormat('ko-KR', {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit',\n      weekday: 'short',\n    });\n    const parts = formatter.formatToParts(target);\n    const year = parts.find((part) => part.type === 'year')?.value ?? '';\n    const month = parts.find((part) => part.type === 'month')?.value ?? '';\n    const day = parts.find((part) => part.type === 'day')?.value ?? '';\n    const weekday = parts.find((part) => part.type === 'weekday')?.value ?? '';\n    return `${year}-${month}-${day} (${weekday})`;\n  } catch {\n    return dateStr;\n  }\n};\n\nconst getTimeRange = (reservation: MobileReservation) => {\n  if (reservation.checkIn || reservation.checkOut) {\n    return `${reservation.checkIn || '-'} ~ ${reservation.checkOut || '-'}`;\n  }\n  return reservation.time || null;\n};\n\nconst getScheduleLabel = (reservation: MobileReservation) => {\n  const dateLabel = formatReservationDate(reservation.date);\n  const timeRange = getTimeRange(reservation);\n  return [dateLabel, timeRange].filter(Boolean).join(' ');\n};\n\nconst getServiceDetail = (reservation: MobileReservation) => {\n  if (reservation.service === 'grooming') {\n    return reservation.style || '미용 예약';\n  }\n  if (reservation.service === 'hotel') {\n    return reservation.roomType || '호텔 예약';\n  }\n  if (reservation.service === 'daycare') {\n    return reservation.roomType || '데이케어 예약';\n  }\n  return SERVICE_LABELS[reservation.service];\n};\n\nexport default function AdminMobileDashboard() {\n  const navigate = useNavigate();\n  const [isAuthorized, setIsAuthorized] = useState(false);\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n  const [processingId, setProcessingId] = useState<string | null>(null);\n\n  const {\n    todayGrooming,\n    todayHotel,\n    todayDaycare,\n    refresh,\n    isLoading,\n    isRefreshing,\n    error: dataError,\n    todayKey,\n  } = useTodayReservationsForMobile(isAuthorized);\n\n  const todayDisplay = formatReservationDate(todayKey);\n\n  useEffect(() => {\n    let mounted = true;\n    const initialize = async () => {\n      try {\n        const session = await adminService.getSession();\n        if (!mounted) return;\n        const user = session?.user;\n        if (!user) {\n          navigate('/admin');\n          return;\n        }\n        localStorage.setItem('adminAuth', 'true');\n        setIsAuthorized(true);\n      } catch (error) {\n        console.error('Failed to initialize mobile dashboard:', error);\n        if (mounted) {\n          setErrorMessage('관리자 인증에 실패했습니다. 다시 로그인해주세요.');\n        }\n      }\n    };\n    initialize();\n    return () => {\n      mounted = false;\n    };\n  }, [navigate]);\n\n  const stats = useMemo<Record<MobileReservation['service'], number> & { total: number }>(() => {\n    return {\n      grooming: todayGrooming.length,\n      hotel: todayHotel.length,\n      daycare: todayDaycare.length,\n      total: todayGrooming.length + todayHotel.length + todayDaycare.length,\n    };\n  }, [todayDaycare.length, todayGrooming.length, todayHotel.length]);\n\n  const sections = useMemo(\n    () => [\n      { ...SERVICE_SECTIONS[0], reservations: todayGrooming },\n      { ...SERVICE_SECTIONS[1], reservations: todayHotel },\n      { ...SERVICE_SECTIONS[2], reservations: todayDaycare },\n    ],\n    [todayDaycare, todayGrooming, todayHotel],\n  );\n\n  const combinedError = errorMessage || dataError;\n\n  const handleRefresh = () => {\n    if (!isRefreshing) {\n      refresh();\n    }\n  };\n\n  const handleLogout = async () => {\n    try {\n      await adminService.logout();\n    } catch (error) {\n      console.error('Failed to logout:', error);\n    } finally {\n      localStorage.removeItem('adminAuth');\n      navigate('/admin');\n    }\n  };\n\n  const handleStatusChange = async (reservationId: string, nextStatus: ReservationStatus) => {\n    setProcessingId(reservationId);\n    setErrorMessage(null);\n    const result = await changeReservationStatus(reservationId, nextStatus);\n    if (!result.success) {\n      setErrorMessage('상태를 업데이트하지 못했습니다. 다시 시도해주세요.');\n    } else {\n      await refresh();\n    }\n    setProcessingId(null);\n  };\n\n  const handleDeleteReservation = async (reservationId: string) => {\n    const confirmed = typeof window === 'undefined' ? true : window.confirm('이 예약을 삭제할까요?');\n    if (!confirmed) return;\n    setProcessingId(reservationId);\n    setErrorMessage(null);\n    const result = await deleteReservationAction(reservationId);\n    if (!result.success) {\n      setErrorMessage('예약을 삭제하지 못했습니다. 잠시 후 다시 시도해주세요.');\n    } else {\n      await refresh();\n    }\n    setProcessingId(null);\n  };\n\n  const renderReservationCard = (reservation: MobileReservation) => {\n    const schedule = getScheduleLabel(reservation);\n    const serviceDetail = getServiceDetail(reservation);\n    return (\n      <article\n        key={reservation.id}\n        className=\"mb-2 flex flex-col gap-1 rounded-xl border border-slate-200 bg-white p-3 shadow-sm\"\n      >\n        <div className=\"flex items-center justify-between gap-3\">\n          <span className=\"text-base font-semibold text-slate-900\">\n            {reservation.petName || reservation.ownerName || '예약'}\n          </span>\n          <span\n            className={`text-xs font-semibold rounded-full border px-2 py-1 ${STATUS_STYLES[reservation.status]}`}\n          >\n            {STATUS_LABELS[reservation.status]}\n          </span>\n        </div>\n        <div className=\"text-xs text-gray-600\">\n          {[schedule, serviceDetail].filter(Boolean).join('  ') || '일정 정보 없음'}\n        </div>\n        {reservation.phone ? <p className=\"text-xs text-slate-500\">{reservation.phone}</p> : null}\n        {reservation.specialNotes ? (\n          <p className=\"rounded-lg bg-slate-50 px-3 py-2 text-sm text-slate-600\">{reservation.specialNotes}</p>\n        ) : null}\n        <div className=\"mt-1 flex justify-end gap-2\">\n          {reservation.status === 'pending' ? (\n            <button\n              type=\"button\"\n              onClick={() => handleStatusChange(reservation.id, 'confirmed')}\n              disabled={processingId === reservation.id}\n              className=\"inline-flex items-center gap-1 rounded-full bg-emerald-500 px-3 py-1 text-xs font-semibold text-white disabled:opacity-50\"\n            >\n              <i className=\"ri-check-line text-sm\" />\n              {processingId === reservation.id ? '처리 중...' : '확정'}\n            </button>\n          ) : null}\n          {(reservation.status === 'pending' || reservation.status === 'confirmed') && (\n            <button\n              type=\"button\"\n              onClick={() => handleStatusChange(reservation.id, 'cancelled')}\n              disabled={processingId === reservation.id}\n              className=\"inline-flex items-center gap-1 rounded-full border border-amber-200 bg-amber-50 px-3 py-1 text-xs font-semibold text-amber-700 disabled:opacity-50\"\n            >\n              <i className=\"ri-close-line text-sm\" />\n              {processingId === reservation.id ? '처리 중...' : '취소'}\n            </button>\n          )}\n          <button\n            type=\"button\"\n            onClick={() => handleDeleteReservation(reservation.id)}\n            disabled={processingId === reservation.id}\n            className=\"inline-flex items-center gap-1 rounded-full border border-slate-300 px-3 py-1 text-xs font-semibold text-slate-700 disabled:opacity-50\"\n          >\n            <i className=\"ri-delete-bin-line text-sm\" />\n            {processingId === reservation.id ? '처리 중...' : '삭제'}\n          </button>\n        </div>\n      </article>\n    );\n  };\n\n  return (\n    <main className=\"min-h-screen bg-slate-50 px-4 py-4\">\n      <div className=\"mx-auto flex w-full max-w-xl flex-col gap-4\">\n        <header className=\"flex flex-col gap-3\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-xs uppercase tracking-[0.3em] text-slate-500\">PuppyHotel</p>\n              <h1 className=\"text-2xl font-semibold text-slate-900\">모바일 관리자</h1>\n            </div>\n            <button\n              type=\"button\"\n              onClick={() => navigate('/admin/dashboard')}\n              className=\"rounded-full border border-slate-300 px-4 py-1 text-sm font-medium text-slate-700\"\n            >\n              데스크톱 버전 보기\n            </button>\n          </div>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-slate-500\">오늘</p>\n              <p className=\"text-lg font-semibold text-slate-900\">{todayDisplay}</p>\n            </div>\n            <button\n              type=\"button\"\n              onClick={handleLogout}\n              className=\"text-sm font-medium text-rose-500 underline-offset-2 hover:underline\"\n            >\n              로그아웃\n            </button>\n          </div>\n        </header>\n\n        {combinedError ? (\n          <div className=\"rounded-2xl border border-rose-100 bg-rose-50 px-4 py-3 text-sm text-rose-700\">\n            {combinedError}\n          </div>\n        ) : null}\n\n        <section className=\"rounded-3xl border border-slate-100 bg-white px-5 py-4 shadow-sm\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <p className=\"text-sm text-slate-500\">오늘 예약</p>\n              <p className=\"text-3xl font-semibold text-slate-900\">{stats.total}</p>\n            </div>\n            <button\n              type=\"button\"\n              onClick={handleRefresh}\n              disabled={isRefreshing}\n              className=\"rounded-full bg-slate-900 px-4 py-2 text-sm font-medium text-white disabled:opacity-50\"\n            >\n              {isRefreshing ? '불러오는 중...' : '새로고침'}\n            </button>\n          </div>\n          <div className=\"mt-4 grid grid-cols-3 gap-2 text-center text-sm\">\n            {(['hotel', 'grooming', 'daycare'] as const).map((service) => (\n              <div key={service} className=\"rounded-2xl bg-slate-50 px-2 py-3\">\n                <p className=\"text-xs text-slate-500\">{SERVICE_LABELS[service]}</p>\n                <p className=\"text-xl font-semibold text-slate-900\">{stats[service]}</p>\n              </div>\n            ))}\n          </div>\n        </section>\n\n        <div className=\"flex flex-col gap-6\">\n          {sections.map((section) => {\n            const isEmpty = !isLoading && section.reservations.length === 0;\n            return (\n              <section key={section.key} className=\"flex flex-col gap-3\">\n                <div className=\"flex items-center justify-between\">\n                  <h2 className=\"text-lg font-semibold text-slate-900\">{section.title}</h2>\n                  <span className=\"rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-700\">\n                    {section.reservations.length}건\n                  </span>\n                </div>\n\n                {isLoading ? (\n                  <div className=\"rounded-3xl border border-slate-100 bg-white px-5 py-8 text-center text-slate-500\">\n                    불러오는 중입니다...\n                  </div>\n                ) : null}\n\n                {isEmpty ? (\n                  <div className=\"rounded-3xl border border-dashed border-slate-200 bg-white px-5 py-8 text-center text-slate-500\">\n                    오늘은 {SERVICE_LABELS[section.key]} 예약이 없습니다.\n                  </div>\n                ) : null}\n\n                {!isLoading && section.reservations.map((reservation) => renderReservationCard(reservation))}\n              </section>\n            );\n          })}\n        </div>\n      </div>\n    </main>\n  );\n}\n"],"names":["SERVICE_ORDER","sortReservations","items","b","serviceDiff","timeA","timeB","getKstDateKey","now","utc","useTodayReservationsForMobile","enabled","todayKey","useMemo","reservations","setReservations","useState","isLoading","setIsLoading","isRefreshing","setIsRefreshing","error","setError","filterToday","useCallback","reservation","fetchReservations","data","reservationService","normalized","convertToLegacyFormat","err","handleRealtimeUpdate","payload","current","updatedReservation","next","useEffect","subscription","subscribeToReservations","grouped","SERVICE_LABELS","SERVICE_SECTIONS","STATUS_LABELS","STATUS_STYLES","formatReservationDate","dateStr","target","parts","year","part","month","day","weekday","getTimeRange","getScheduleLabel","dateLabel","timeRange","getServiceDetail","AdminMobileDashboard","navigate","useNavigate","isAuthorized","setIsAuthorized","errorMessage","setErrorMessage","processingId","setProcessingId","todayGrooming","todayHotel","todayDaycare","refresh","dataError","todayDisplay","mounted","session","adminService","stats","sections","combinedError","handleRefresh","handleLogout","handleStatusChange","reservationId","nextStatus","changeReservationStatus","handleDeleteReservation","deleteReservationAction","renderReservationCard","schedule","serviceDetail","jsxs","jsx","service","section","isEmpty"],"mappings":"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"}
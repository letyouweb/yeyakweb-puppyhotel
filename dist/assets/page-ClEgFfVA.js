import{r as a,u as F,j as e}from"./index-DeoPKrxh.js";import{a as m}from"./supabase-BdgGiW7Q.js";function D(){const[c,v]=a.useState(""),[y,w]=a.useState(""),[i,r]=a.useState(""),[S,j]=a.useState(!1),[k,x]=a.useState(""),[u,d]=a.useState(""),[g,o]=a.useState(1),[s,n]=a.useState(!1),[f,h]=a.useState(""),p=F(),N=()=>(f||c).trim(),E=async t=>{t.preventDefault(),r(""),n(!0);try{await m.login(c,y)&&(localStorage.setItem("adminAuth","true"),localStorage.setItem("adminEmail",c),p("/admin/dashboard"))}catch{r("이메일 또는 비밀번호가 올바르지 않습니다.")}finally{n(!1)}},A=()=>{j(!0),o(1),x(""),d(""),h(""),r("")},C=async t=>{t.preventDefault(),r("");const l=N();if(!l){r("관리자 이메일을 입력해주세요.");return}n(!0);try{const b=await m.getSecurityQuestion(l);x(b),o(2)}catch{r("등록된 계정을 찾을 수 없습니다.")}finally{n(!1)}},q=async t=>{t.preventDefault(),r("");const l=N();if(!l){r("관리자 이메일을 입력해주세요.");return}if(!u.trim()){r("보안 질문 답변을 입력해주세요.");return}n(!0);try{await m.verifySecurityAnswer(l,u),await m.triggerPasswordReset(l),d(""),o(3)}catch{r("보안 답변이 일치하지 않습니다.")}finally{n(!1)}},P=()=>{j(!1),o(1),x(""),d(""),h(""),r("")};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-teal-50 to-blue-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-teal-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("i",{className:"ri-shield-user-line text-2xl text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 로그인"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"보호자 관리 시스템"})]}),S?e.jsxs("div",{className:"space-y-6",children:[g===1&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"계정 확인"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"등록된 관리자 이메일을 입력하면 보안 질문을 안내해 드립니다."})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"이메일"}),e.jsx("input",{type:"email",value:f||c,onChange:t=>h(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",placeholder:"관리자 이메일을 입력하세요",required:!0,disabled:s})]}),i&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-red-600 text-sm flex items-center",children:[e.jsx("i",{className:"ri-error-warning-line mr-2"}),i]})}),e.jsx("button",{type:"submit",disabled:s,className:"w-full bg-teal-600 text-white py-3 rounded-lg font-semibold hover:bg-teal-700 transition-colors disabled:opacity-50",children:s?"확인 중...":"보안 질문 확인"})]})]}),g===2&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"보안 질문"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"등록된 답변을 입력해 주세요. 일치하면 비밀번호 재설정 메일을 보내드립니다."})]}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"질문"}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:e.jsx("p",{className:"text-gray-800",children:k||"등록된 보안 질문이 없습니다."})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"답변"}),e.jsx("input",{type:"text",value:u,onChange:t=>d(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",placeholder:"보안 질문 답변을 입력하세요",required:!0,disabled:s})]}),i&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-red-600 text-sm flex items-center",children:[e.jsx("i",{className:"ri-error-warning-line mr-2"}),i]})}),e.jsx("button",{type:"submit",disabled:s,className:"w-full bg-teal-600 text-white py-3 rounded-lg font-semibold hover:bg-teal-700 transition-colors disabled:opacity-50",children:s?"확인 중...":"답변 제출"})]})]}),g===3&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx("i",{className:"ri-mail-send-line text-xl text-green-600"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"재설정 메일을 전송했습니다."}),e.jsx("p",{className:"text-gray-600 text-sm",children:"이메일의 안내를 따라 새 비밀번호를 설정해 주세요."})]}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:P,className:"text-gray-600 hover:text-gray-700 text-sm font-medium",disabled:s,children:[e.jsx("i",{className:"ri-arrow-left-line mr-1"}),"로그인으로 돌아가기"]})})]}):e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-mail-line mr-2"}),"관리자 이메일"]}),e.jsx("input",{type:"email",value:c,onChange:t=>v(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",placeholder:"이메일을 입력하세요",required:!0,disabled:s})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx("i",{className:"ri-lock-line mr-2"}),"비밀번호"]}),e.jsx("input",{type:"password",value:y,onChange:t=>w(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",placeholder:"비밀번호를 입력하세요",required:!0,disabled:s})]}),i&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-red-600 text-sm flex items-center",children:[e.jsx("i",{className:"ri-error-warning-line mr-2"}),i]})}),e.jsx("button",{type:"submit",disabled:s,className:"w-full bg-teal-600 text-white py-3 rounded-lg font-semibold hover:bg-teal-700 transition-colors disabled:opacity-50",children:s?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line mr-2 animate-spin"}),"로그인 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-login-box-line mr-2"}),"로그인"]})}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsxs("button",{type:"button",onClick:A,className:"text-teal-600 hover:text-teal-700 text-sm font-medium block w-full",disabled:s,children:[e.jsx("i",{className:"ri-question-line mr-1"}),"비밀번호를 잊으셨나요?"]}),e.jsxs("button",{type:"button",onClick:()=>p("/admin/signup"),className:"text-gray-600 hover:text-gray-900 text-sm font-medium block w-full",disabled:s,children:[e.jsx("i",{className:"ri-user-add-line mr-1"}),"처음이신가요? 회원가입"]})]})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"text-center text-xs text-gray-500",children:[e.jsx("p",{children:"© 2025 yeyakweb All rights reserved."}),e.jsx("p",{className:"mt-1",children:"문의: 010-8241-1619"})]})})]})})}export{D as default};
//# sourceMappingURL=page-ClEgFfVA.js.map
